03:46 johnny@johnny14:~/Workspace/cs287/hw3$ luajit HW3.lua -datafile PTB1000.hdf5 -classifier nn1 -out predictions1000.txt -eta 0.003
Classifier  nn1
Outfile predictions1000.txt
Validate    0
Reading
datafile    PTB1000.hdf5
nwords  1000
nfeatures   5
Init time:  0.276088
Training models:
train dims:
 887521
      5
[torch.LongStorage of size 2]

SGD m:  32
eta:    0.003
epochs: 20
normalize:  1
downsample: 0
Iteration:  1
Time:   0.286224
Loss    4.1110142286154
Train
-4.1246268902745
-7.6607449455849
-4.0800063810972
-0.49558504668959
-1.4927240146285
-3.3935383583203
-8.7395990048024
-8.24560518827
-5.8459954041426
-1.3002016638735
Perplexity  47.299701979287
Valid
-1.7451331551729
-6.0413243904727
-5.4641949919615
-0.77379877500757
-7.1961596802003
-4.7988865794834
-0.69444233440458
-4.1955914167519
-7.4970845421599
-0.58969111329776
Perplexity  49.69408856123
Iteration:  2
Time:   181.931575
Loss    3.783095230168
Train
-1.4982679345694
-4.6354914258121
-0.66683668885094
-0.71915461633636
-6.0847755320557
-2.3495790667487
-0.35107959546709
-5.1530244098761
-3.8471294726682
-5.1292725427869
Perplexity  41.179284409564
Valid
-1.3012723995184
-6.3370076355097
-6.4011296776366
-0.89679468458411
-6.6795724705158
-3.9225023854506
-0.65955560385897
-4.5417636537665
-6.9972210098543
-0.37274065961108
Perplexity  43.789203168348
Iteration:  3
Time:   361.212251
Loss    3.6770896408898
Train
-7.0509116471758
-2.0156176432987
-4.7141599822706
-8.0467631655079
-0.76488561362046
-2.4478530337759
-1.4319165607047
-1.3046618848155
-1.2718975773815
-7.9013272957519
Perplexity  37.766593978614
Valid
-1.3598138465252
-6.345946974408
-6.4169317056931
-0.58231324587047
-5.7085019435395
-4.277105155347
-0.99751676765947
-4.4538287436974
-6.2759198799417
-0.55304076990275
Perplexity  40.367110993395
Iteration:  4
Time:   566.355266
Loss    3.6153165629948
Train
-0.90539847674406
-5.1856438555583
-2.0788965985997
-1.2628908878913
-1.2100994932508
-1.1077482729979
-5.5942403069777
-1.5733491439985
-1.0189466508094
-7.4480810139333
Perplexity  35.292734575989
Valid
-1.3068826878273
-6.3946182399372
-5.8260462957521
-0.64674082294965
-5.5996003305872
-4.0165038362726
-0.98906611163561
-4.8514945343486
-5.9568854428024
-0.68657662730981
Perplexity  38.98498919118
Iteration:  5
Time:   849.132233
Loss    3.5719062106418
Train
-9.0811915984733
-7.0499182076268
-2.9558998683882
-4.359665600806
-0.6534584071193
-2.3795332748548
-1.9123425999508
-1.2517265335233
-0.70698534331135
-5.2285089116445
Perplexity  34.494907763858
Valid
-1.3695972892206
-6.4391395015813
-6.9029903111017
-0.77145714357859
-5.8788315474364
-3.6997182798591
-0.66287623152561
-4.6875153675706
-5.5275790557669
-0.44367313217587
Perplexity  37.963217871248
Iteration:  6
Time:   1168.045002
Loss    3.5401830584545
Train
-5.573474039802
-0.96203707452287
-2.9118860007705
-3.3755875922937
-1.466982389623
-6.2178994686886
-1.1170865281487
-1.6259188228626
-0.56379468394387
-2.4523879446384
Perplexity  33.916951834473
Valid
-1.3393321725421
-5.8760498795627
-5.8222570140011
-0.65648491980643
-5.9231336666149
-3.233006660156
-0.48596955691918
-5.3296965053349
-5.249414799447
-0.56895169881308
Perplexity  37.902071897477
Iteration:  7
Time:   1489.100912
Loss    3.514767712588
Train
-9.0241809797598
-1.3259620813539
-5.783519146704
-5.6047199505152
-1.8878186337963
-1.0966090874636
-2.5589356558443
-7.9865006345163
-7.1128513140053
-0.9468365586964
Perplexity  32.223131292312
Valid
-1.9266893853665
-6.2040428653343
-6.5027398179275
-0.6402888399711
-5.606805528318
-3.7648551601283
-0.52470406396421
-5.1928311658042
-5.1159602355056
-0.43203832659369
Perplexity  36.55287646736
Iteration:  8
Time:   1825.569662
Loss    3.4951914667371
Train
-1.939070675227
-4.6299729605166
-0.87740979081322
-1.1510235679199
-10.38630010275
-1.0469346154961
-2.3672962071977
-1.0200765856747
-3.283120788497
-4.1946481233519
Perplexity  31.785634513463
Valid
-1.4940171728337
-5.9520731656333
-5.8599780535798
-1.180662439915
-5.4581260969085
-3.6590836503618
-0.8860766273164
-4.5915877858108
-5.2826587508533
-0.68921666492635
Perplexity  36.083600944467
Iteration:  9
Time:   2147.595906
Loss    3.4787777099075
Train
-3.7696137743855
-4.0040167685225
-2.012054007123
-4.6477861799546
-5.8275437196762
-2.6991631801261
-1.7287247998886
-0.62329805991899
-1.4703926327538
-1.202925358926
Perplexity  31.41358650826
Valid
-2.0160582396517
-6.457074434146
-5.6807698160671
-0.81493104144744
-6.0253906729924
-3.4284149969217
-0.61837140851927
-6.1691607955981
-5.7330935557286
-0.57091375222454
Perplexity  35.993975560697
Iteration:  10
Time:   2449.862696
Loss    3.46430630786
Train
-0.84331443836921
-2.107639603762
-6.9451475917855
-4.1600973864577
-0.03222302448216
-1.2257054063077
-1.5112246923265
-0.70648348364634
-8.8945856247184
-0.16297685042944
Perplexity  31.12707021014
Valid
-1.3693320419505
-6.6791988920191
-6.4449331753614
-0.65595240289793
-5.7641834377459
-4.2611591302926
-0.93812518291877
-5.3278008257348
-5.5567889838954
-0.65003096446429
Perplexity  36.053113513674
Iteration:  11
Time:   2676.776227
Loss    3.4530487264475
Train
-1.7128686189673
-0.69532810783267
-0.0077177042275025
-4.9732067662459
-7.7372544121992
-4.1189091031865
-0.94182941105789
-4.29833539373
-0.79228178237964
-8.4867490380197
Perplexity  31.216498415689
Valid
-1.9800492117169
-5.9437458048365
-5.5519736489051
-0.39856112944454
-5.6389824097575
-3.6765276737938
-0.77616820543807
-5.9274167810349
-6.052942460152
-0.36143678464355
Perplexity  36.419600763947
Iteration:  12
Time:   3005.887961
Loss    3.4431234709839
Train
-1.0993711013703
-0.63415309353052
-2.1653859278409
-1.4385382301358
-2.2195779605466
-2.0671337186782
-4.6585276690264
-2.2070492693179
-8.5630043168617
-1.1427580851442
Perplexity  30.002964795208
Valid
-2.0671337186782
-6.2518649563422
-6.283192459282
-0.4393610421552
-5.9801173791126
-3.7917911336381
-0.63202328698534
-5.2917906098367
-5.6853261523081
-0.54773375858636
Perplexity  35.175485270538
Iteration:  13
Time:   3320.247452
Loss    3.4345128427297
Train
-1.6639129021705
-0.0057022578948675
-3.6535779662469
-6.7846064850887
-2.3968855053862
-0.086012131662343
-6.5760292043834
-2.7704756225845
-5.9775569500631
-1.2603843898822
Perplexity  30.045003518891
Valid
-1.5240396265893
-5.9364919626797
-5.4754269653295
-0.22400633290474
-6.029433293609
-3.5098034111396
-1.0070993484794
-5.2760543528143
-5.1777948962739
-0.67877736304456
Perplexity  35.65738649886
Iteration:  14
Time:   3630.246023
Loss    3.4269757588545
Train
-1.9917189777657
-0.87495578749359
-6.5855466154995
-4.2454891543292
-1.8868584183024
-0.98007208069576
-1.6233429465051
-2.2149759094654
-2.2562649706256
-2.3994773474996
Perplexity  29.583658460973
Valid
-1.0288031773028
-5.8888241757836
-5.6596723051585
-0.70026094430806
-6.0463004440666
-4.0761172223831
-0.87743370420317
-5.9732609677556
-5.5242383333836
-0.81878511115056
Perplexity  35.419057890764
Iteration:  15
Time:   3956.431024
Loss    3.4204364553734
Train
-9.7578006397389
-10.548878418654
-1.1721168586301
-1.0256728902621
-2.9686717606352
-4.2133473539315
-1.4810228689199
-1.8122520228002
-9.3533002098585
-5.7229108013361
Perplexity  29.114315438908
Valid
-1.8122520228002
-6.5587263886547
-5.7345275244306
-0.3299652637604
-5.24220138876
-4.4716181541674
-0.54485669591724
-6.216460582738
-6.3228701221629
-0.46238743623117
Perplexity  35.354077653732
Iteration:  16
Time:   4269.19718
Loss    3.414736302633
Train
-1.9239817169652
-3.6052456706325
-1.01350679779
-3.5873340582638
-9.3655747322915
-4.8857544016623
-5.8717238019532
-6.4310824709081
-0.79703804220466
-7.6399905861799
Perplexity  28.884481119283
Valid
-1.4647227664722
-6.4045919024551
-5.2876554347545
-0.37838902556074
-6.4777391776115
-3.8344996759662
-0.62385867764753
-5.9401071495251
-5.3839889178347
-0.54896915098507
Perplexity  35.023237092479
Iteration:  17
Time:   4574.815493
Loss    3.4090338346992
Train
-3.1721984645048
-6.5987869486411
-1.4088049450669
-1.3668160964294
-2.663434021043
-2.1832293767708
-5.257225878308
-3.7050963181334
-3.2567248401613
-3.8638587665356
Perplexity  29.158941561061
Valid
-1.33778194603
-5.8234306017123
-6.3339939893397
-0.4489670123063
-6.1099483575421
-3.6971691424286
-0.67242818831811
-6.0143498658798
-6.0447705390701
-0.5977273447516
Perplexity  34.92936235871
Iteration:  18
Time:   4787.246839
Loss    3.404332674805
Train
-4.1028606224271
-1.2465010305769
-9.8629340012106
-1.632776982776
-3.267881476682
-3.3189605129679
-8.9032838388252
-4.1954583766639
-2.7194235362054
-1.2710402878726
Perplexity  29.4344193607
Valid
-1.8909632786978
-6.0276739450638
-5.2606072498582
-0.22483926604531
-6.1726553079617
-3.897938329159
-0.51201648399572
-6.027800251375
-7.195665168548
-0.67045009783568
Perplexity  35.156525299582
Iteration:  19
Time:   5112.732381
Loss    3.3997620245825
Train
-3.1427772496524
-8.9351480796434
-6.3574018217611
-6.892195392023
-6.5182068788651
-0.71947353480459
-5.6775679569264
-3.3048375685241
-2.7727091308083
-6.0214680217573
Perplexity  29.217634358033
Valid
-1.593758232423
-6.1484327474464
-6.8297796327517
-0.76578323401467
-5.6769693616179
-3.4480938692982
-0.74720030677857
-5.6250622404129
-7.418825365527
-0.47746765514836
Perplexity  34.909269542213
Iteration:  20
Time:   5351.304701
Loss    3.3960777861387
Train
-1.7002430309856
-3.0607801774949
-3.8291221320599
-3.7951117827111
-0.69925184290939
-1.8155871772619
-3.0698841566004
-3.9998955126242
-1.2816382064107
-2.8322384542398
Perplexity  28.682867813138
Valid
-1.5903593909417
-7.4211825831591
-6.1613559480506
-0.61440505765931
-5.9212717125229
-3.8099209729935
-0.50065777823493
-5.9464955609823
-5.6888554458388
-0.64227707253155
Perplexity  35.001403929018
Training time:  5588.143537
Testing models:
Train
-1.5903593909417
-1.0495502853723
-1.3168072607181
-1.2695131705484
-1.2241936821223
-1.2457189570071
-1.2457189570071
-1.2457189570071
-1.2457189570071
-1.2457189570071
Perplexity  28.6088196323
Valid
-1.5903593909417
-7.4211825831591
-6.1613559480506
-0.61440505765931
-5.9212717125229
-3.8099209729935
-0.50065777823493
-5.9464955609823
-5.6888554458388
-0.64227707253155
Perplexity  35.001403929018
Testing time:   5851.718549
Writing output:
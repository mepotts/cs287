12:41 johnny@johnny14:~/Workspace/cs287/hw3$ luajit HW3.lua -datafile PTB.hdf5 -classifier nn2 -out predictionsNCE2.txt -epochs 25
Classifier  nn2
Outfile predictionsNCE2.txt
Embed out
Validate    0
Reading
datafile    PTB.hdf5
nwords  10001
nfeatures   5
Computing frequencies:
Init time:  0.954678
Training models:
train dims:
 929589
      5
[torch.LongStorage of size 2]

SGD m:  32
eta:    0.005
epochs: 25
normalize:  1
downsample: 0
Iteration:  1
Time:   1.016862
Loss    8.6424525788531
Train
-7.1405151890764
-6.0727861188841
-9.4388263759664
-8.5475618903389
-8.3735037259438
-10.248884586665
-11.236035347374
-11.78345605471
-6.8359303963945
-9.7467321894774
Perplexity  22659.870328298
Valid
-11.141716523521
-9.6150175467915
-11.045997654185
-4.751919705137
-10.673660847828
-9.0735239164516
-16.112989248088
-9.1075263053835
-11.303312281734
-14.263610799038
Perplexity  22110.9349902
Iteration:  2
Time:   648.907839
Loss    4.3679704826339
Train
-12.469470629491
-8.7267517922455
-5.7539703021786
-13.175244474615
-12.821700753656
-7.7985292813074
-11.599169356475
-13.728931983779
-8.0879068914399
-7.7591402781665
Perplexity  17651.01899994
Valid
-11.976189697499
-9.3018388927293
-9.04493567486
-5.4513728632638
-9.6701273001834
-8.2355190531792
-13.272157120541
-9.2341729281181
-10.294723239385
-14.07068519945
Perplexity  17873.968436305
Iteration:  3
Time:   1210.283053
Loss    4.1760004649435
Train
-8.0608778468275
-12.771167302506
-7.2295756998082
-6.2361150035238
-6.8881863239221
-6.1555595202628
-11.962058792513
-5.755392606074
-8.5523782035895
-13.165470586589
Perplexity  14287.771417448
Valid
-13.065922078204
-8.7278627515878
-10.064742302943
-5.8096848378754
-10.058175078058
-8.8613145357499
-12.284926521012
-9.5546741941416
-9.9835376771572
-12.710659037108
Perplexity  15109.051593061
Iteration:  4
Time:   1764.477531
Loss    4.0720224662799
Train
-13.760023215419
-7.1934225804133
-12.480453202817
-6.0360055559487
-12.332000918115
-8.0986117935623
-13.393531883344
-6.9436090344554
-5.5923052748236
-13.550693991091
Perplexity  12995.086607005
Valid
-11.961693193985
-6.9966085492124
-9.9027759812703
-5.7612428384108
-10.25998591801
-8.6608035499867
-15.253118304044
-8.7927709718564
-10.235413799685
-11.996291600405
Perplexity  14351.902638593
Iteration:  5
Time:   2317.129896
Loss    3.9824843336877
Train
-11.664523874108
-10.005728192692
-7.3980305032453
-14.327175910007
-10.746650791855
-14.980733666579
-11.623790714816
-8.0826599152379
-10.109707164846
-6.966193837761
Perplexity  12293.00761687
Valid
-12.195534380888
-9.5491112120061
-9.5115932536861
-4.8445935076611
-9.0285975549256
-9.5900570060567
-14.335056373084
-10.039062931976
-9.8081663956086
-13.698302018453
Perplexity  13695.896042728
Iteration:  6
Time:   2868.351556
Loss    3.9199672670635
Train
-11.887118056435
-7.9533768687984
-7.4332744377116
-7.6791983368207
-9.8965355551431
-12.18118997511
-9.7665662984774
-12.424632384472
-13.66037280197
-8.5557108948159
Perplexity  12638.940655676
Valid
-12.689283789868
-8.9097278974537
-8.5608386503333
-5.0761157327375
-8.4908403535794
-7.6141768898267
-14.574058678858
-10.515540041275
-8.8631492057488
-12.771561814485
Perplexity  14418.720150054
Iteration:  7
Time:   3421.191054
Loss    3.8736790367636
Train
-5.4108792654894
-10.437554125465
-12.75746319304
-10.690742918992
-9.6289884827238
-4.2235735640449
-12.281777070412
-7.7864387044791
-11.325812375653
-5.11258048153
Perplexity  12386.025861233
Valid
-13.190269501554
-9.1145858490553
-9.0779518722385
-5.0560948586141
-10.191418855855
-9.5880744836751
-16.019025298489
-10.389711325526
-9.9750908609616
-13.479131314052
Perplexity  14538.944868526
Iteration:  8
Time:   3972.868033
Loss    3.8060901547006
Train
-9.1995381535468
-8.0585326799641
-10.08295545254
-10.369127405568
-8.9694193327471
-6.3966640848665
-13.421482505639
-6.8462680151566
-8.1170302846362
-10.635309797539
Perplexity  9753.8190914102
Valid
-11.862767092344
-9.2315696778468
-9.4818581272097
-4.8170605300486
-9.7986569560712
-8.1761326503413
-14.606974296418
-10.722982331581
-9.0440860046144
-12.71232555772
Perplexity  11656.728905782
Iteration:  9
Time:   4523.99493
Loss    3.7626002359637
Train
-9.9731403071511
-10.960491240006
-11.398085484608
-9.5099728725186
-10.779437084295
-11.527957960108
-12.362238224249
-6.5697480558792
-10.298079907472
-11.423066173206
Perplexity  10764.10202729
Valid
-12.063360023507
-9.0202498742449
-9.3867364683074
-4.8021071628176
-10.113863274623
-8.756498323165
-14.741059762671
-10.583388584465
-8.4816866780421
-12.39401129621
Perplexity  13260.69992588
Iteration:  10
Time:   5075.892122
Loss    3.7204993764079
Train
-8.2600519897976
-13.85919663967
-9.3677200442595
-12.631352518245
-10.146819651097
-6.2958762058057
-12.73034468908
-7.7109401122675
-5.030100138656
-11.262820703903
Perplexity  8902.6503838207
Valid
-12.405327705588
-9.964791960944
-9.7186461120486
-4.2507960186645
-7.297705772347
-7.0755309626748
-14.139139783693
-10.367230661352
-8.4653805418275
-13.457056294513
Perplexity  11004.3908272
Iteration:  11
Time:   5627.191652
Loss    3.706249558454
Train
-10.683623201059
-12.157664873184
-11.247279201662
-12.41176516294
-7.5761612754057
-9.5068068792306
-9.5279131651305
-5.6901987725578
-7.4759000407164
-13.560083243897
Perplexity  10638.691000598
Valid
-12.501105691952
-9.3655585458967
-10.302001335168
-5.7378756967684
-9.4281812476147
-8.8115699556808
-14.43311328948
-10.013985836175
-10.23011189447
-13.402480464658
Perplexity  13327.413858628
Iteration:  12
Time:   6204.312967
Loss    3.6812450909284
Train
-11.614835477462
-7.7524980542991
-8.4294105654418
-11.390126289113
-10.127937209103
-6.2096503405806
-7.4268283158156
-2.9690102294407
-6.6615373402212
-8.2760296997325
Perplexity  7828.2024695273
Valid
-10.848630808627
-9.1271559779753
-9.4311124394037
-4.7643061764841
-10.937426242151
-6.7820952866636
-14.677142377586
-10.738435722023
-10.162037315017
-12.536065290056
Perplexity  9921.1550120377
Iteration:  13
Time:   6791.868471
Loss    3.6566009096806
Train
-13.830100144959
-12.951405719351
-10.71364192971
-11.715578875444
-9.6052305306347
-13.383665365814
-9.6663216959265
-12.563456387816
-11.516349102678
-8.7548193342231
Perplexity  10578.312654258
Valid
-12.782752533742
-9.4583221734815
-11.286762852596
-5.2861888602946
-9.5750495836386
-9.6920592493883
-15.360805979973
-11.257977859034
-9.0061569165689
-12.982733384664
Perplexity  13933.448447162
Iteration:  14
Time:   7406.374799
Loss    3.6289585685302
Train
-13.302722936404
-7.7793491043377
-11.321884101759
-8.3778761446301
-8.5375773047893
-9.1028884781953
-11.068269244531
-8.265254636837
-13.953937545777
-11.077252218033
Perplexity  8792.3767021131
Valid
-11.879740529486
-9.3905904824749
-9.3550909956207
-5.3260596174321
-9.6498327520854
-7.2868262318629
-15.10603499425
-11.136264668242
-8.0598440669207
-10.305453202869
Perplexity  11573.160295627
Iteration:  15
Time:   8038.204507
Loss    3.6100983857196
Train
-6.9264105267161
-10.339874728607
-8.1425063194265
-3.4975153989479
-4.9078858982562
-7.0088159375883
-6.5213040936984
-6.6880491141285
-6.7270154217327
-6.6470471908146
Perplexity  7951.2181135442
Valid
-12.255518017408
-8.4037627728248
-8.3578261608445
-5.1551217110026
-9.1168471148745
-8.4669127392728
-15.356870832852
-11.330470952281
-9.055530345131
-12.930085489334
Perplexity  10466.018350654
Iteration:  16
Time:   8669.889009
Loss    3.5896310597245
Train
-6.5777837947278
-10.912212458689
-7.9409318769556
-7.6669728879955
-11.759168622418
-7.5113397563405
-7.8401982147599
-8.247728191163
-7.5502530251647
-6.7813327352814
Perplexity  7753.7306290091
Valid
-12.456830423166
-10.138590006592
-11.033687633268
-5.723869382843
-9.7822543818119
-7.0308199516804
-14.636130409341
-9.3195823434323
-6.9835645549391
-12.025484954795
Perplexity  10246.09294708
Iteration:  17
Time:   9336.529328
Loss    3.5740089818142
Train
-7.7540948959758
-8.009152157447
-6.7855887851307
-10.576442977137
-11.482190608944
-12.576570159555
-5.2207228155303
-13.289566292361
-6.7331812397011
-6.7331812397011
Perplexity  7470.5270399557
Valid
-12.032172882875
-8.9629827296763
-9.4978639606486
-4.0154877564202
-9.6635025487114
-6.7320412994044
-14.3982287058
-9.4282492592664
-8.5133736774866
-11.994313621604
Perplexity  10236.226545713
Iteration:  18
Time:   9977.061593
Loss    3.5514867396545
Train
-7.4678297253631
-9.9034902925561
-8.7937243788655
-8.187920561665
-12.725709598424
-5.4908860037025
-4.8711590644801
-8.6603308310659
-7.704758713825
-7.4581951696289
Perplexity  11600.60249422
Valid
-13.071455545005
-8.2637780924401
-9.5407392220425
-6.0252240504336
-10.940829148845
-7.754687889738
-14.005609401929
-11.793079023107
-8.1672323096194
-12.001204251091
Perplexity  16115.237982704
Iteration:  19
Time:   10626.978516
Loss    3.5397192617398
Train
-10.57231513906
-8.3424961589775
-8.9880427561092
-6.1118706848645
-11.165000370684
-9.9028432487319
-6.3857898586364
-9.1931577922437
-6.0467349914791
-8.7184046265681
Perplexity  6400.9906084778
Valid
-11.73751798795
-8.175486746864
-8.8423071861858
-4.8324388515815
-8.349541846428
-5.9031246749641
-13.679317989797
-10.292096101874
-7.846966680824
-11.724141832824
Perplexity  9216.461367536
Iteration:  20
Time:   11282.036048
Loss    3.5310723964083
Train
-11.327635683915
-13.341662213121
-9.3893925599649
-13.819566191544
-6.8781979694775
-13.913082806495
-8.7676534012769
-6.7160987233385
-6.9926943227628
-9.9844868453502
Perplexity  6699.5451680933
Valid
-11.536147864005
-7.7214749796942
-8.3567583362509
-5.7165073034788
-8.7913607574213
-7.3138544836922
-14.99264631653
-9.5564864445771
-9.2837697167251
-11.527137543353
Perplexity  9669.0378776083
Iteration:  21
Time:   11954.256439
Loss    3.5133709214741
Train
-7.2270587100985
-7.4452717961801
-11.973190608317
-7.6895357836954
-12.828238063913
-11.957997000519
-12.29423371985
-9.7512549092671
-5.3103605833262
-7.5742474599697
Perplexity  7128.4114947927
Valid
-11.848935216812
-8.2508123806689
-8.3867828003609
-5.891830351891
-9.2718679420606
-7.7701389046548
-14.92563220272
-10.595996319014
-8.7115999962822
-11.463981315698
Perplexity  10359.561136814
Iteration:  22
Time:   12610.011233
Loss    3.5014632038065
Train
-8.8396849162678
-6.5190663347512
-14.020386757094
-12.67605282763
-7.9739060099581
-13.319900625893
-9.5848161928152
-6.864367479368
-4.5213262587916
-8.1948667118689
Perplexity  7670.6364893104
Valid
-12.926195803092
-9.2338260312473
-9.7481112964873
-5.1406792855766
-8.9887179675708
-8.0928808560354
-15.667461364532
-10.685953020402
-8.8103686062198
-11.698195955268
Perplexity  11229.509982313
Iteration:  23
Time:   13264.258413
Loss    3.4956361914067
Train
-5.9075055955477
-13.189445979362
-5.4012694673674
-6.2977791162554
-8.2333808098427
-7.5165366931829
-5.1594288859246
-6.7025319385894
-13.524010187883
-11.45089704699
Perplexity  8022.6850508552
Valid
-10.975486810334
-8.189904949402
-9.8903502573328
-5.0522440981667
-11.285127205085
-7.30331197456
-15.445534086923
-10.429986147497
-9.6893633115329
-11.480922106402
Perplexity  11639.680914527
Iteration:  24
Time:   13904.802807
Loss    3.4972944673394
Train
-8.079161477138
-5.5870905774716
-5.7592916438663
-10.286200911532
-5.2416921533828
-5.1335360733679
-7.6736483442107
-4.3795332416132
-10.509372121278
-7.038629486642
Perplexity  5403.1198964547
Valid
-12.053558479358
-9.5046062999464
-7.8113887044223
-4.7739736107542
-10.134939342754
-7.2930944209247
-13.748001117941
-9.1834773474907
-7.4329203462226
-10.971336965638
Perplexity  8074.1037220875
Iteration:  25
Time:   14549.938194
Loss    3.4845091476819
Train
-8.9672751700673
-10.292227741863
-14.252693283386
-13.515824820245
-2.6209833387263
-14.47958733789
-5.2733318872141
-12.557792622301
-10.122242816335
-8.0581206498423
Perplexity  8544.9066468426
Valid
-12.316301155665
-7.8121108389002
-9.0816439148047
-4.38203346333
-8.7917461012644
-7.9399632902773
-13.881806422651
-10.390187293886
-8.4080990072285
-10.535055470242
Perplexity  12776.398411275
Training time:  15202.81923
Testing models:
Train
-10.471016168668
-8.2422346702045
-8.1659506799352
-11.621288297709
-10.173560213492
-6.8158221344813
-8.7172328990231
-6.1646847204742
-10.479324476312
-4.274790052035
Perplexity  161.52631710381
Valid
-8.1141292439532
-4.4468108393898
-5.3735742904828
-0.62630333522019
-6.1746840906887
-4.360342959776
-11.035700670536
-6.6503380820716
-4.3781003577785
-6.9444086576876
Perplexity  238.8606352635
Testing time:   16647.094437
Writing output:
Predicting time:    16652.946546